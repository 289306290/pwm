<!--
  ~ Password Management Servlets (PWM)
  ~ http://www.pwm-project.org
  ~
  ~ Copyright (c) 2006-2009 Novell, Inc.
  ~ Copyright (c) 2009-2017 The PWM Project
  ~
  ~ This program is free software; you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation; either version 2 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program; if not, write to the Free Software
  ~ Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
  -->

<mf-app-bar>
    <div id="page-content-title" class="page-content-title" translate="Title_HelpDesk">Help Desk</div>
    <mf-icon-button
        icon="password_thin"
        ng-attr-title="{{ 'Button_ChangePassword' | translate }}"
        ng-click=""
        id="password-icon"></mf-icon-button>
    <mf-icon-button
        icon="unlock_thin"
        ng-attr-title="{{ 'Button_Unlock' | translate }}"
        ng-click=""
        id="unlock-icon"></mf-icon-button>
    <mf-icon-button
        icon="reload_refresh_thin"
        ng-attr-title="{{ 'Display_CaptchaRefresh' | translate }}"
        ng-click=""
        id="reload-refresh-icon"></mf-icon-button>
</mf-app-bar>



<person-card person="$ctrl.personCard" show-image="$ctrl.photosEnabled">
</person-card>

<div class="help-desk-content">
    <div class="person-details-content">
        <mf-tabset>
            <mf-tab id="Field_Profile" label="Profile">
                <table>
                    <tbody>
                    <tr ng-repeat="item in $ctrl.person.profileData">
                        <td ng-bind="item.label"></td>
                        <td ng-bind="item.value | dateFilter" ng-if="item.type==='timestamp'"></td>
                        <td ng-bind="item.value" ng-if="item.type==='string' || item.type==='number'"></td>
                        <td ng-bind="value" ng-if="item.type==='multiString'" ng-repeat="value in item.values"></td>
                    </tr>
                    </tbody>
                </table>
            </mf-tab>
            <mf-tab id="Title_Status" label="Status">
                <table>
                    <tbody>
                    <tr ng-repeat="item in $ctrl.person.statusData">
                        <td ng-bind="item.label"></td>
                        <td ng-bind="item.value | dateFilter" ng-if="item.type==='timestamp'"></td>
                        <td ng-bind="item.value" ng-if="item.type==='string' || item.type==='number'"></td>
                        <td ng-bind="value" ng-if="item.type==='multiString'" ng-repeat="value in item.values"></td>
                    </tr>
                    </tbody>
                </table>
            </mf-tab>
            <mf-tab ng-if="!!$ctrl.person.userHistory" id="Title_UserEventHistory" label="Password History">
                <table>
                    <tbody>
                    <tr ng-repeat="item in $ctrl.person.userHistory">
                        <td ng-bind="item.timestamp | dateFilter"></td>
                        <td ng-bind="item.label"></td>
                    </tr>
                    </tbody>
                </table>
            </mf-tab>
            <mf-tab id="Title_PasswordPolicy" label="Password Policy">
                <table>
                    <tbody>
                    <tr>
                        <td ng-bind="'Field_Policy' | translate"></td>
                        <td ng-bind="$ctrl.person.passwordPolicyDN"></td>
                    </tr>
                    <tr>
                        <td ng-bind="'Field_Profile' | translate"></td>
                        <td ng-bind="$ctrl.person.passwordPolicyID"></td>
                    </tr>
                    <tr>
                        <td ng-bind="'Field_Display' | translate"></td>
                        <td>
                            <ul>
                                <li ng-repeat="item in $ctrl.person.passwordRequirements" ng-bind="item"></li>
                            </ul>
                        </td>
                    </tr>
                    <hr>
                    <tr ng-repeat="(key, item) in $ctrl.person.passwordPolicyRules">
                        <td ng-bind="key"></td>
                        <td ng-bind="item"></td>
                    </tr>
                    </tbody>
                </table>
            </mf-tab>
            <mf-tab id="Title_SecurityResponses" label="Security Responses">
                <table>
                    <tbody>
                    <tr ng-repeat="item in $ctrl.person.helpdeskResponses">
                        <td ng-bind="item.label"></td>
                        <td ng-bind="item.value | dateFilter" ng-if="item.type==='timestamp'"></td>
                        <td ng-bind="item.value" ng-if="item.type==='string' || item.type==='number'"></td>
                        <td ng-bind="value" ng-if="item.type==='multiString'" ng-repeat="value in item.values"></td>
                    </tr>
                    </tbody>
                </table>
            </mf-tab>
        </mf-tabset>
    </div>

    <div class="help-desk-buttons">
        <mf-button ng-click="$ctrl.gotoSearch()"
                   ng-disabled="$ctrl.buttonDisabled('back')"
                   ng-if="$ctrl.buttonVisible('back')">{{ 'Button_GoBack' | translate }}</mf-button>
        <mf-button ng-click="$ctrl.refresh()"
                   ng-disabled="$ctrl.buttonDisabled('refresh')"
                   ng-if="$ctrl.buttonVisible('refresh')">{{ 'Display_CaptchaRefresh' | translate }}</mf-button>
        <mf-button ng-click="$ctrl.changePassword()"
                   ng-disabled="$ctrl.buttonDisabled('changePassword')"
                   ng-if="$ctrl.buttonVisible('changePassword')">{{ 'Button_ChangePassword' | translate }}</mf-button>
        <mf-button ng-click="$ctrl.unlockUser()"
                   ng-disabled="$ctrl.buttonDisabled('unlock')"
                   ng-if="$ctrl.buttonVisible('unlock')">{{ 'Button_Unlock' | translate }}</mf-button>
        <mf-button ng-disabled="$ctrl.buttonDisabled('clearResponses')"
                   ng-if="$ctrl.buttonVisible('clearResponses')">{{ 'Button_ClearResponses' | translate }}</mf-button>
        <mf-button ng-disabled="$ctrl.buttonDisabled('clearOtpSecret')"
                   ng-if="$ctrl.buttonVisible('clearOtpSecret')">{{ 'Button_HelpdeskClearOtpSecret' | translate }}</mf-button>
        <mf-button ng-click="$ctrl.verifyUser()"
                   ng-disabled="$ctrl.buttonDisabled('verification')"
                   ng-if="$ctrl.buttonVisible('verification')">{{ 'Button_Verify' | translate }}</mf-button>
        <mf-button ng-disabled="$ctrl.buttonDisabled('deleteUser')"
                   ng-if="$ctrl.buttonVisible('deleteUser')">{{ 'Button_Delete' | translate }}</mf-button>
        <mf-button ng-repeat="button in $ctrl.person.customButtons"
                   ng-attr-title="{{button.description}}">{{ button.label }}</mf-button>
    </div>
</div>